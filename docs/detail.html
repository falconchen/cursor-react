<html><head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GeoNotes - 笔记详情</title>
<style>
    body, html {
        margin: 0;
        padding: 0;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
        background-color: #F4F4F4;
        color: #333;
        height: 100%;
    }
    .container {
        max-width: 414px;
        margin: 0 auto;
        background-color: white;
        height: 100%;
        display: flex;
        flex-direction: column;
        box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    header {
        background-color: #F9E3E0;
        padding: 15px 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    .header-title {
        font-size: 18px;
        font-weight: bold;
    }
    .header-actions {
        display: flex;
        gap: 15px;
    }
    .icon {
        width: 24px;
        height: 24px;
        cursor: pointer;
    }
    .edit-container {
        flex-grow: 1;
        display: flex;
        flex-direction: column;
        padding: 20px;
    }
    .edit-section {
        margin-bottom: 20px;
    }
    .edit-textarea {
        width: 100%;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 4px;
        font-size: 16px;
        height: 150px;
        resize: vertical;
    }
    .image-upload-section {
        display: flex;
        align-items: center;
        gap: 10px;
        border: 1px dashed #ccc;
        padding: 10px;
        border-radius: 4px;
        cursor: pointer;
    }
    .image-upload-icon {
        width: 24px;
        height: 24px;
        fill: #F9776F;
    }
    .image-upload-text {
        font-size: 14px;
        color: #666;
    }
    .location-section {
        display: flex;
        flex-direction: column;
        gap: 10px;
    }
    .location-info {
        display: flex;
        align-items: center;
        gap: 10px;
    }
    .location-icon {
        width: 24px;
        height: 24px;
        fill: #F9776F;
    }
    #map {
        width: 100%;
        height: 200px;
        border-radius: 4px;
        overflow: hidden;
    }
    .save-button {
        background-color: #F9776F;
        color: white;
        border: none;
        padding: 12px;
        border-radius: 4px;
        font-size: 16px;
        font-weight: bold;
        cursor: pointer;
        margin-top: auto;
    }
    #imageUpload {
        display: none;
    }
    .location-note-input {
        width: 100%;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 4px;
        font-size: 14px;
        margin-top: 10px;
    }
</style>
</head>
<body>
    <div class="container">
        <header>
            <svg class="icon" viewBox="0 0 24 24" fill="#333" id="backButton">
                <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
            </svg>
            <span class="header-title">编辑笔记</span>
            <div class="header-actions">
                <svg class="icon" viewBox="0 0 24 24" fill="#333" id="deleteButton">
                    <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                </svg>
            </div>
        </header>
        
        <div class="edit-container">
            <div class="edit-section">
                <textarea class="edit-textarea" placeholder="输入笔记内容"></textarea>
            </div>
            
            <div class="edit-section image-upload-section" id="imageUploadSection">
                <svg class="image-upload-icon" viewBox="0 0 24 24">
                    <path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/>
                </svg>
                <span class="image-upload-text">上传图片（可选）</span>
                <input type="file" id="imageUpload" accept="image/*">
            </div>
            
            <div class="edit-section location-section">
                <div class="location-info">
                    <svg class="location-icon" viewBox="0 0 24 24">
                        <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
                    </svg>
                    <span id="locationText">正在获取位置...</span>
                </div>
                <input type="text" class="location-note-input" placeholder="地点备注（可选）" id="locationNote">
                <div id="map"></div>
            </div>
            
            <button class="save-button">保存</button>
        </div>
    </div>

    <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_GOOGLE_MAPS_API_KEY&callback=initMap" async defer></script>
    <script>
        let map, marker;

        function initMap() {
            map = new google.maps.Map(document.getElementById('map'), {
                center: {lat: 0, lng: 0},
                zoom: 15
            });
        }

        function updateMap(position) {
            const latLng = {
                lat: position.coords.latitude,
                lng: position.coords.longitude
            };
            
            map.setCenter(latLng);
            
            if (marker) {
                marker.setPosition(latLng);
            } else {
                marker = new google.maps.Marker({
                    position: latLng,
                    map: map,
                    title: '您的位置'
                });
            }

            document.getElementById('locationText').textContent = `纬度: ${latLng.lat.toFixed(6)}, 经度: ${latLng.lng.toFixed(6)}`;
        }

        document.addEventListener('DOMContentLoaded', () => {
            const backButton = document.getElementById('backButton');
            backButton.addEventListener('click', () => {
                window.location.href = 'https://websim.ai/c/vYuqVro1lAQtZcari';
            });

            const deleteButton = document.getElementById('deleteButton');
            deleteButton.addEventListener('click', () => {
                if (confirm('确定要删除这个笔记吗？')) {
                    alert('笔记已删除');
                    window.location.href = 'https://websim.ai/c/vYuqVro1lAQtZcari';
                }
            });

            const saveButton = document.querySelector('.save-button');
            saveButton.addEventListener('click', () => {
                const locationNote = document.getElementById('locationNote').value;
                alert(`笔记已保存${locationNote ? '，地点备注：' + locationNote : ''}`);
                window.location.href = 'https://websim.ai/c/vYuqVro1lAQtZcari';
            });

            const imageUploadSection = document.getElementById('imageUploadSection');
            const imageUploadInput = document.getElementById('imageUpload');
            
            imageUploadSection.addEventListener('click', () => {
                imageUploadInput.click();
            });

            imageUploadInput.addEventListener('change', (event) => {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        imageUploadSection.style.backgroundImage = `url(${e.target.result})`;
                        imageUploadSection.style.backgroundSize = 'cover';
                        imageUploadSection.style.backgroundPosition = 'center';
                        imageUploadSection.querySelector('.image-upload-text').textContent = file.name;
                    }
                    reader.readAsDataURL(file);
                }
            });

            if ("geolocation" in navigator) {
                navigator.geolocation.getCurrentPosition(function(position) {
                    updateMap(position);
                }, function(error) {
                    console.error("Error: " + error.message);
                    document.getElementById('locationText').textContent = '无法获取位置';
                });
            } else {
                console.log("Geolocation is not supported by this browser.");
                document.getElementById('locationText').textContent = '不支持地理位置';
            }
        });
    </script>
</body>
</html>